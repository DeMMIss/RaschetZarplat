# Расчёт задолженности ЗП из-за непроведённой индексации

Консольное приложение на C# (.NET 8) для расчёта задолженности по заработной плате из-за непроведённой работодателем индексации с расчётом компенсации по ст. 236 ТК РФ.

**Репозиторий**: [https://github.com/DeMMIss/RaschetZadoljennosti](https://github.com/DeMMIss/RaschetZadoljennosti)

## Возможности

- Расчёт недоплаты за каждый период выплаты (аванс/расчёт) из-за непроведённой индексации
- Расчёт компенсации за задержку выплаты заработной платы по ст. 236 ТК РФ (1/150 ключевой ставки ЦБ за каждый день просрочки)
- Учёт рабочих дней в праздники (оплата по двойной суточной ставке)
- Автоматическая загрузка производственного календаря РФ
- Автоматическая загрузка ключевой ставки ЦБ РФ через SOAP API
- Экспорт результатов в Excel с детализацией

## Требования

- .NET 8 SDK или выше
- Доступ к интернету (для загрузки производственного календаря и ключевой ставки ЦБ)

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/DeMMIss/RaschetZadoljennosti.git
cd RaschetZadoljennosti
```

2. Восстановите зависимости:
```bash
dotnet restore
```

3. Соберите проект:
```bash
dotnet build
```

## Использование

Запустите приложение:
```bash
dotnet run
```

При запуске программа запросит следующие данные:

1. **Тип оклада** (1 — gross, 2 — net на руки)
2. **Размер месячного оклада** (в рублях)
3. **День выплаты аванса** (число месяца, например 25)
4. **День выплаты расчёта** (число следующего месяца, например 10)
5. **Процент индексации** (%)
6. **Дата, с которой должна была быть индексация** (дд.мм.гггг)
7. **Дата расчёта задолженности** (дд.мм.гггг)
8. **Рабочие дни в праздники** (даты через запятую, дд.мм.гггг, или пусто)

После ввода данных программа:
- Загрузит производственный календарь РФ за указанный период
- Загрузит историю ключевой ставки ЦБ РФ
- Рассчитает задолженность и компенсацию
- Выведет результаты в консоль
- Сохранит детальный отчёт в Excel файл `Расчет_задолженности_ЗП.xlsx`

## Структура проекта

```
РасчетЗадолженностиЗП/
├── Models/                    # Модели данных
│   ├── SalaryInput.cs        # Входные параметры расчёта
│   ├── PaymentRecord.cs      # Запись о выплате
│   └── KeyRateRecord.cs      # Запись ключевой ставки ЦБ
├── Services/                  # Сервисы
│   ├── ProductionCalendarService.cs    # Работа с производственным календарём
│   ├── CbKeyRateService.cs             # Получение ключевой ставки ЦБ
│   ├── SalaryCalculationService.cs      # Расчёт зарплаты и недоплаты
│   ├── CompensationCalculationService.cs # Расчёт компенсации
│   └── ExcelExportService.cs           # Экспорт в Excel
└── Program.cs                # Точка входа приложения
```

## Логика расчёта

### Расчёт зарплаты

- **Аванс** = оклад / рабочие дни в месяце × рабочие дни с 1 по 14 число
- **Расчёт** = оклад / рабочие дни в месяце × рабочие дни с 15 по конец месяца
- **Рабочие дни в праздники** = суточная ставка × 2 × количество праздничных дней

### Недоплата

Недоплата рассчитывается как разница между индексированной суммой (net) и фактически выплаченной суммой (net) для каждого периода выплаты.

### Компенсация (ст. 236 ТК РФ)

Компенсация рассчитывается как:
```
Компенсация = Недоплата × (Ключевая ставка ЦБ / 150) × Количество дней просрочки / 100
```

Расчёт учитывает изменения ключевой ставки ЦБ в течение периода просрочки.

## Источники данных

- **Производственный календарь**: [xmlcalendar.ru](https://xmlcalendar.ru/)
- **Ключевая ставка ЦБ РФ**: SOAP API Банка России ([cbr.ru](https://www.cbr.ru/development/dws/))

## Лицензия

MIT License

## Автор

Разработано для расчёта задолженности по заработной плате с учётом требований Трудового кодекса РФ.
