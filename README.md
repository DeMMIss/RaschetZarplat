# Расчёт выплат зарплаты

WPF приложение на C# (.NET 8) для расчёта выплат по заработной плате, включая расчёт задолженности из-за непроведённой индексации с расчётом компенсации по ст. 236 ТК РФ.

## Возможности

Приложение предоставляет графический интерфейс для:
- Расчёта авансов и расчётов за отработанные дни
- Расчёта выплат по больничным листам
- Расчёта отпускных выплат
- Расчёта доплат за работу в праздничные и выходные дни
- Расчёта задолженности из-за непроведённой индексации
- Расчёта компенсации за задержку выплат по ст. 236 ТК РФ
- Расчёта компенсации за неиспользованный отпуск при увольнении
- Экспорта результатов в Excel и CSV

## Логика расчетов

Приложение выполняет два типа расчетов:

### Первичные расчеты (всегда выполняются)

Первичные расчеты выполняются всегда и включают:
- **Авансы и расчеты** — расчет сумм авансов и расчетов за отработанные дни с учетом больничных и отпусков
- **Больничные** — расчет сумм выплат по больничным листам
- **Отпуска** — расчет сумм отпускных выплат
- **Переработки в праздничные дни** — расчет доплат за работу в выходные и праздничные дни (двойная оплата согласно ст. 153 ТК РФ)

### Опциональные расчеты (управляются флагами)

Опциональные расчеты выполняются только при включении соответствующих флагов:

1. **Недоплаты из-за непроведения индексации** (`calculateIndexationUnderpayments`)
   - Пересчет выплат с учетом индексации
   - Расчет недоплат (разница между индексированными и неиндексированными суммами)
   - Расчет компенсации за задержку выплат по ст. 236 ТК РФ (не менее 1/150 ключевой ставки ЦБ РФ за каждый день задержки)

2. **Компенсация за неиспользованный отпуск при увольнении** (`calculateUnusedVacationCompensation`)
   - Расчет компенсации за неиспользованные дни отпуска при увольнении
   - Учет индексации при расчете компенсации

## Требования

- .NET 8 Runtime или выше
- Windows (WPF приложение)
- Доступ к интернету (для загрузки производственного календаря и ключевой ставки ЦБ)

## Использование

### Запуск приложения

Запустите `РасчетВыплатЗарплаты.exe`. При первом запуске приложение автоматически попытается загрузить конфигурацию из файла `config.json` в директории приложения (если файл существует).

### Работа с интерфейсом

Приложение имеет графический интерфейс с несколькими разделами:

1. **Зарплата** — настройка параметров оклада, дней выплаты аванса и расчёта, параметров испытательного срока
2. **Индексация** — настройка даты найма, базовой зарплаты и событий индексации
3. **Дополнительно** — настройка работы в праздничные дни, больничных и отпусков
4. **Расчёт** — выбор даты расчёта и опций расчёта (индексация, компенсация за отпуск)

### Управление конфигурацией

- **Загрузить конфиг** — загрузить конфигурацию из JSON файла
- **Сохранить конфиг** — сохранить текущую конфигурацию в JSON файл

Приложение автоматически загружает `config.json` при запуске, если файл находится в директории приложения.

### Результаты расчёта

После нажатия кнопки "Рассчитать" открывается окно результатов с вкладками:
- **Сводка** — общая информация о расчёте, недоплатах, компенсациях
- **Все выплаты** — детальная таблица всех выплат с возможностью группировки по месяцам
- **Детали компенсации** — детальная информация о компенсации по ст. 236 ТК РФ (при включённом расчёте индексации)

Из окна результатов можно экспортировать данные:
- **Экспорт в Excel** — создаёт файл `РасчетВыплатЗарплаты.xlsx` с несколькими листами
- **Экспорт в CSV** — создаёт файл `РасчетВыплатЗарплаты.csv`

## Конфигурационный файл

Создайте файл `config.json` на основе шаблона `config.template.json`:

### Структура конфигурации

**`salary`** — параметры зарплаты:
- `monthlySalary` (decimal) — месячный оклад в рублях
- `salaryType` (string) — тип оклада: `"Net"` (на руки) или `"Gross"` (до НДФЛ)
- `advancePayDay` (int) — день месяца выплаты аванса (1-31)
- `settlementPayDay` (int) — день следующего месяца выплаты расчёта (1-28)
- `probationSalary` (decimal, опционально) — оклад на период испытательного срока
- `probationPeriodMonths` (int, опционально) — длительность испытательного срока в месяцах

**`indexation`** — параметры индексации:
- `hireDate` (string, опционально) — дата найма в формате `"YYYY-MM-DD"`
- `baseSalaryNet` (decimal, опционально) — базовая зарплата на дату найма (net, в рублях)
- `indexationEvents` (array) — массив событий индексации:
  - `date` (string) — дата индексации в формате `"YYYY-MM-DD"`
  - `percent` (decimal) — процент индексации
  - `isPerformed` (bool) — была ли индексация проведена (`false` — не проведена, для таких событий рассчитывается задолженность)

**`calculation`** — параметры расчёта:
- `calculationDate` (string) — дата расчёта задолженности в формате `"YYYY-MM-DD"`
- `calculateIndexationUnderpayments` (bool, опционально) — включить расчёт недоплат из-за непроведения индексации и компенсации за задержку выплат (по умолчанию `false`)
- `calculateUnusedVacationCompensation` (bool, опционально) — включить расчёт компенсации за неиспользованный отпуск при увольнении (по умолчанию `false`)
- `dismissalDate` (string, опционально) — дата предполагаемого увольнения в формате `"YYYY-MM-DD"` (требуется при `calculateUnusedVacationCompensation: true`)

**`holidayWork`** — работа в праздничные дни:
- `dates` (array) — массив дат работы в праздники в формате `"YYYY-MM-DD"`
- `dailyRateMethod` (string) — метод расчёта среднесуточного оклада:
  - `"MonthlyWorkDays"` — по количеству рабочих дней в месяце расчёта (по умолчанию)
  - `"AverageMonthlyWorkDaysPerYear"` — по среднемесячному количеству рабочих дней в году расчёта

**`sickLeaves`** (array) — периоды больничных (массив объектов):
- `from` (string) — дата начала в формате `"YYYY-MM-DD"`
- `to` (string) — дата окончания в формате `"YYYY-MM-DD"`
- `amount` (decimal) — сумма выплаты по больничному (net, в рублях)

**`vacations`** (array) — периоды отпусков (массив объектов):
- `from` (string) — дата начала в формате `"YYYY-MM-DD"`
- `to` (string) — дата окончания в формате `"YYYY-MM-DD"`
- `amount` (decimal) — сумма отпускных (net, в рублях)

## Порядок выполнения расчетов

1. **Загрузка данных**
   - Производственный календарь (для определения рабочих дней и праздников)
   - Ключевая ставка ЦБ РФ (только при включенном `calculateIndexationUnderpayments`)

2. **Первичные расчеты**
   - Расчет авансов и расчетов за каждый месяц периода
   - Расчет выплат по больничным
   - Расчет выплат по отпускам
   - Расчет доплат за работу в праздничные дни

3. **Опциональные расчеты** (при включенных флагах)
   - При `calculateIndexationUnderpayments: true`:
     - Пересчет всех выплат с учетом индексации
     - Расчет недоплат
     - Расчет компенсации за задержку выплат
   - При `calculateUnusedVacationCompensation: true`:
     - Расчет компенсации за неиспользованный отпуск при увольнении

## Законодательные требования

При расчетах учитываются следующие нормативные акты:

- **Авансы и расчеты**: Статья 136 ТК РФ — выплата не позднее 15 дней после окончания периода
- **Больничные**: Федеральный закон №255-ФЗ — расчет на основе среднего заработка
- **Отпуска**: Статья 139 ТК РФ — расчет на основе среднего заработка за 12 месяцев
- **Переработки в праздники**: Статья 153 ТК РФ — двойная оплата
- **Индексация**: Статья 134 ТК РФ — индексация в связи с ростом потребительских цен
- **Компенсация за задержку**: Статья 236 ТК РФ — не менее 1/150 ключевой ставки ЦБ РФ за каждый день задержки
