<Window x:Class="Ð Ð°ÑÑ‡ÐµÑ‚Ð’Ñ‹Ð¿Ð»Ð°Ñ‚Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ñ‹.ResultsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Ð Ð°ÑÑ‡ÐµÑ‚Ð’Ñ‹Ð¿Ð»Ð°Ñ‚Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ñ‹"
        Title="Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð°" 
        Height="800" Width="1200"
        MinHeight="600" MinWidth="1000"
        WindowStartupLocation="CenterScreen"
        SizeToContent="Manual">
    <Window.Resources>
        <local:TotalPaymentConverter x:Key="TotalPaymentConverter"/>
        <local:ExpandIconConverter x:Key="ExpandIconConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <TabControl Grid.Row="0">
            <TabItem Header="Ð¡Ð²Ð¾Ð´ÐºÐ°">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="SummaryPanel" Margin="15">
                        <GroupBox Header="ðŸ’µ ÐžÐºÐ»Ð°Ð´ Ð¸ Ð¸Ð½Ð´ÐµÐºÑÐ°Ñ†Ð¸Ð¸" Margin="0,0,0,15" FontSize="13">
                            <StackPanel Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="ÐžÐºÐ»Ð°Ð´:" FontWeight="Bold" Margin="0,0,10,5" FontSize="13"/>
                                    <TextBlock x:Name="SalaryTextBlock" Grid.Row="0" Grid.Column="1" Margin="0,0,0,5" FontSize="13"/>
                                </Grid>
                                <ItemsControl x:Name="IndexationRulesItemsControl" Margin="0,10,0,0"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox x:Name="DebtGroupBox" Header="ðŸ’° Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð° Ð·Ð°Ð´Ð¾Ð»Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸" Margin="0,0,0,15" FontSize="13">
                            <StackPanel Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="ÐžÐ±Ñ‰Ð°Ñ Ð½ÐµÐ´Ð¾Ð¿Ð»Ð°Ñ‚Ð°:" FontWeight="SemiBold" Margin="0,0,10,8" FontSize="14"/>
                                    <TextBlock x:Name="TotalUnderpaymentTextBlock" Grid.Row="0" Grid.Column="1" Margin="0,0,0,8" FontSize="14" 
                                               Foreground="{StaticResource WarningColor}" FontWeight="SemiBold"/>
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="ÐšÐ¾Ð¼Ð¿ÐµÐ½ÑÐ°Ñ†Ð¸Ñ Ð¿Ð¾ ÑÑ‚. 236 Ð¢Ðš Ð Ð¤:" FontWeight="SemiBold" Margin="0,0,10,8" FontSize="14"/>
                                    <TextBlock x:Name="TotalCompensationTextBlock" Grid.Row="1" Grid.Column="1" Margin="0,0,0,8" FontSize="14" 
                                               Foreground="{StaticResource WarningColor}" FontWeight="SemiBold"/>
                                    <Border Grid.Row="2" Grid.ColumnSpan="2" Background="{StaticResource AccentLightColor}" 
                                            BorderBrush="{StaticResource PrimaryColor}" BorderThickness="2" 
                                            CornerRadius="4" Padding="12" Margin="0,10,0,0">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="Ð˜Ð¢ÐžÐ“Ðž Ðš Ð’Ð«ÐŸÐ›ÐÐ¢Ð•:" FontWeight="Bold" FontSize="16" 
                                                       Foreground="{StaticResource PrimaryColor}" Margin="0,0,10,0"/>
                                            <TextBlock x:Name="TotalToPayTextBlock" Grid.Column="1" FontWeight="Bold" FontSize="18" 
                                                       Foreground="{StaticResource PrimaryColor}"/>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox x:Name="HolidayWorkGroupBox" Header="ðŸŽ‰ Ð Ð°Ð±Ð¾Ñ‚Ð° Ð² Ð¿Ñ€Ð°Ð·Ð´Ð½Ð¸Ñ‡Ð½Ñ‹Ðµ Ð´Ð½Ð¸" Margin="0,0,0,15" FontSize="13">
                            <ItemsControl x:Name="HolidayWorkItemsControl" Margin="10"/>
                        </GroupBox>
                        
                        <GroupBox x:Name="SickLeaveGroupBox" Header="ðŸ¥ Ð‘Ð¾Ð»ÑŒÐ½Ð¸Ñ‡Ð½Ñ‹Ðµ" Margin="0,0,0,15" FontSize="13">
                            <ItemsControl x:Name="SickLeaveItemsControl" Margin="10"/>
                        </GroupBox>
                        
                        <GroupBox x:Name="VacationPaymentsGroupBox" Header="ðŸ–ï¸ ÐžÑ‚Ð¿ÑƒÑÐºÐ½Ñ‹Ðµ Ð²Ñ‹Ð¿Ð»Ð°Ñ‚Ñ‹" Margin="0,0,0,15" FontSize="13">
                            <ItemsControl x:Name="VacationPaymentsItemsControl" Margin="10"/>
                        </GroupBox>
                        
                        <GroupBox x:Name="UnusedVacationGroupBox" Header="ðŸŽ¯ ÐšÐ¾Ð¼Ð¿ÐµÐ½ÑÐ°Ñ†Ð¸Ñ Ð·Ð° Ð½ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¾Ñ‚Ð¿ÑƒÑÐº" Margin="0,0,0,15" FontSize="13">
                            <StackPanel Margin="10">
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="ÐŸÐµÑ€Ð¸Ð¾Ð´ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹:" FontWeight="SemiBold" Margin="0,0,10,8" FontSize="13"/>
                                    <TextBlock x:Name="UnusedVacationHireDateTextBlock" Grid.Row="0" Grid.Column="1" Margin="0,0,20,8" FontSize="13"/>
                                    <TextBlock Grid.Row="0" Grid.Column="2" Text="â€”" Margin="0,0,10,8" FontSize="13"/>
                                    <TextBlock x:Name="UnusedVacationDismissalDateTextBlock" Grid.Row="0" Grid.Column="3" Margin="0,0,0,8" FontSize="13"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="ÐžÑ‚Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾:" FontWeight="SemiBold" Margin="0,0,10,8" FontSize="13"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Margin="0,0,20,8" FontSize="13">
                                        <Run x:Name="UnusedVacationWorkMonthsTextBlock"/>
                                        <Run Text=" Ð¼ÐµÑ."/>
                                    </TextBlock>
                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="Ð”Ð½Ð¸ Ð¾Ñ‚Ð¿ÑƒÑÐºÐ°:" FontWeight="SemiBold" Margin="0,0,10,8" FontSize="13"/>
                                    <TextBlock Grid.Row="1" Grid.Column="3" Margin="0,0,0,8" FontSize="13">
                                        <Run Text="Ð—Ð°Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾: "/>
                                        <Run x:Name="UnusedVacationEarnedDaysTextBlock" FontWeight="SemiBold"/>
                                        <Run Text=" | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¾: "/>
                                        <Run x:Name="UnusedVacationUsedDaysTextBlock" FontWeight="SemiBold"/>
                                        <Run Text=" | ÐÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¾: "/>
                                        <Run x:Name="UnusedVacationUnusedDaysTextBlock" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                    </TextBlock>
                                    
                                    <Border Grid.Row="2" Grid.ColumnSpan="4" Background="{StaticResource AccentLightColor}" 
                                            BorderBrush="{StaticResource BorderColor}" BorderThickness="1" 
                                            CornerRadius="4" Padding="15" Margin="0,5,0,0">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto" MinWidth="200"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto" MinWidth="200"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Text="Ð‘ÐµÐ· ÑƒÑ‡ÐµÑ‚Ð° Ð¸Ð½Ð´ÐµÐºÑÐ°Ñ†Ð¸Ð¸" 
                                                       FontWeight="Bold" FontSize="13" Margin="0,0,0,10" 
                                                       Foreground="{StaticResource TextSecondaryColor}"/>
                                            <TextBlock Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="2" Text="Ð¡ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ Ð¸Ð½Ð´ÐµÐºÑÐ°Ñ†Ð¸Ð¸" 
                                                       FontWeight="Bold" FontSize="13" Margin="0,0,0,10" 
                                                       Foreground="{StaticResource PrimaryColor}"/>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð´Ð½ÐµÐ²Ð½Ð¾Ð¹ Ð·Ð°Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ðº (gross):" 
                                                       Margin="0,0,10,5" FontSize="13"/>
                                            <TextBlock x:Name="UnusedVacationAvgDailyWithoutTextBlock" Grid.Row="1" Grid.Column="1" 
                                                       Margin="0,0,20,5" FontSize="13" HorizontalAlignment="Right"/>
                                            <TextBlock Grid.Row="1" Grid.Column="2" Text="Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð´Ð½ÐµÐ²Ð½Ð¾Ð¹ Ð·Ð°Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ðº (gross):" 
                                                       Margin="0,0,10,5" FontSize="13"/>
                                            <TextBlock x:Name="UnusedVacationAvgDailyWithTextBlock" Grid.Row="1" Grid.Column="3" 
                                                       Margin="0,0,0,5" FontSize="13" HorizontalAlignment="Right" 
                                                       Foreground="{StaticResource PrimaryColor}" FontWeight="SemiBold"/>
                                            
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ÐšÐ¾Ð¼Ð¿ÐµÐ½ÑÐ°Ñ†Ð¸Ñ (net):" 
                                                       FontWeight="SemiBold" Margin="0,0,10,0" FontSize="13"/>
                                            <TextBlock x:Name="UnusedVacationCompensationWithoutTextBlock" Grid.Row="2" Grid.Column="1" 
                                                       Margin="0,0,20,0" FontSize="13" HorizontalAlignment="Right"/>
                                            <TextBlock Grid.Row="2" Grid.Column="2" Text="ÐšÐ¾Ð¼Ð¿ÐµÐ½ÑÐ°Ñ†Ð¸Ñ (net):" 
                                                       FontWeight="SemiBold" Margin="0,0,10,0" FontSize="13"/>
                                            <TextBlock x:Name="UnusedVacationCompensationWithTextBlock" Grid.Row="2" Grid.Column="3" 
                                                       Margin="0,0,0,0" FontSize="13" HorizontalAlignment="Right" 
                                                       Foreground="{StaticResource PrimaryColor}" FontWeight="Bold"/>
                                        </Grid>
                                    </Border>
                                </Grid>
                                
                                <Border Background="{StaticResource AccentLightColor}" 
                                        BorderBrush="{StaticResource PrimaryColor}" BorderThickness="2" 
                                        CornerRadius="4" Padding="15" Margin="0,10,0,0">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="ÐÐµÐ´Ð¾Ð¿Ð»Ð°Ñ‚Ð° Ð¸Ð·-Ð·Ð° Ð½ÐµÐ¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð½Ð¾Ð¹ Ð¸Ð½Ð´ÐµÐºÑÐ°Ñ†Ð¸Ð¸:" 
                                                   FontWeight="Bold" Margin="0,0,10,0" FontSize="15" 
                                                   Foreground="{StaticResource TextPrimaryColor}"/>
                                        <TextBlock x:Name="UnusedVacationDifferenceTextBlock" Grid.Column="1" 
                                                   FontWeight="Bold" FontSize="18" 
                                                   Foreground="{StaticResource PrimaryColor}" HorizontalAlignment="Right"/>
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <TabItem x:Name="OptionalCalculationsTabItem" Header="ðŸ“‹ ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ñ‹">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="OptionalCalculationsPanel" Margin="15">
                        <GroupBox x:Name="VacationPayGroupBox" Header="ðŸ–ï¸ Ð Ð°ÑÑ‡Ñ‘Ñ‚ Ð¾Ñ‚Ð¿ÑƒÑÐºÐ½Ñ‹Ñ…" Margin="0,0,0,15" FontSize="13">
                            <ItemsControl x:Name="VacationPayItemsControl" Margin="10"/>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <TabItem Header="ðŸ’³ Ð’Ñ‹Ð¿Ð»Ð°Ñ‚Ñ‹">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Ð’ÑÐµ ÑÑƒÐ¼Ð¼Ñ‹ ÑƒÐºÐ°Ð·Ð°Ð½Ñ‹ Ð² Ñ€ÑƒÐ±Ð»ÑÑ… (net - Ð½Ð° Ñ€ÑƒÐºÐ¸)" 
                               FontSize="12" Foreground="{StaticResource TextSecondaryColor}" 
                               Margin="0,0,0,10" FontStyle="Italic"/>
                    
                    <DataGrid x:Name="PaymentsDataGrid" Grid.Row="1" IsReadOnly="True" 
                              AutoGenerateColumns="False" GridLinesVisibility="Horizontal"
                              FontSize="13" HeadersVisibility="Column"
                              SelectionMode="Single" SelectionUnit="FullRow"
                              CanUserResizeColumns="True"
                              LoadingRow="PaymentsDataGrid_LoadingRow"
                              SelectionChanged="PaymentsDataGrid_SelectionChanged">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="Background" Value="White"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsGroup}" Value="True">
                                        <Setter Property="Background" Value="{StaticResource AccentLightColor}"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="ÐŸÐµÑ€Ð¸Ð¾Ð´" Width="220" MinWidth="200">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" x:Name="ExpandIcon" 
                                                       Text="â–¶" FontSize="12" Margin="5,0,8,0" 
                                                       VerticalAlignment="Center" Visibility="Collapsed"
                                                       FontWeight="Bold"
                                                       RenderTransformOrigin="0.5,0.5">
                                                <TextBlock.RenderTransform>
                                                    <RotateTransform x:Name="ExpandIconTransform" Angle="0"/>
                                                </TextBlock.RenderTransform>
                                            </TextBlock>
                                            <TextBlock Grid.Column="1" x:Name="PeriodText" 
                                                       Text="{Binding PeriodDisplay}" 
                                                       VerticalAlignment="Center" Padding="8,4"
                                                       HorizontalAlignment="Left"
                                                       FontWeight="Normal"
                                                       TextWrapping="Wrap"/>
                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding IsGroup}" Value="True">
                                                <Setter TargetName="ExpandIcon" Property="Visibility" Value="Visible"/>
                                                <Setter TargetName="PeriodText" Property="FontWeight" Value="Bold"/>
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Ð¢Ð¸Ð¿ Ð²Ñ‹Ð¿Ð»Ð°Ñ‚Ñ‹" Width="200" MinWidth="180">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding TypeDisplay}" Padding="8,4" 
                                                   TextWrapping="Wrap" VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Ð”Ð°Ñ‚Ð° Ð²Ñ‹Ð¿Ð»Ð°Ñ‚Ñ‹" Width="140" MinWidth="130">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock x:Name="DateTextBlock" 
                                                   HorizontalAlignment="Center" Padding="8,4"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding PaymentDate, StringFormat='dd.MM.yyyy'}"/>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding IsGroup}" Value="True">
                                                <Setter TargetName="DateTextBlock" Property="Text" Value="â€”"/>
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Ð’Ñ‹Ð¿Ð»Ð°Ñ‡ÐµÐ½Ð¾" Width="150" MinWidth="140">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Padding="8,4"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding NetAmount, StringFormat='N2'}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="ÐÐ”Ð¤Ð›" Width="130" MinWidth="120">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Padding="8,4"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding NdflAmount, StringFormat='N2'}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ Ð²Ñ‹Ð¿Ð»Ð°Ñ‡ÐµÐ½Ð¾" Width="180" MinWidth="170">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Padding="8,4"
                                                   VerticalAlignment="Center"
                                                   Foreground="{StaticResource PrimaryColor}" FontWeight="SemiBold"
                                                   Text="{Binding IndexedNetAmount, StringFormat='N2'}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="ÐÐµÐ´Ð¾Ð¿Ð»Ð°Ñ‚Ð°" Width="140" MinWidth="130">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Padding="8,4"
                                                   VerticalAlignment="Center"
                                                   Foreground="{StaticResource WarningColor}" FontWeight="SemiBold"
                                                   Text="{Binding Underpayment, StringFormat='N2'}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="ÐšÐ¾Ð¼Ð¿ÐµÐ½ÑÐ°Ñ†Ð¸Ñ (ÑÑ‚. 236 Ð¢Ðš Ð Ð¤)" Width="200" MinWidth="180">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Padding="8,4"
                                                   VerticalAlignment="Center"
                                                   Foreground="{StaticResource WarningColor}" FontWeight="SemiBold"
                                                   Text="{Binding Compensation, StringFormat='N2'}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Ð˜Ñ‚Ð¾Ð³Ð¾ Ðº Ð´Ð¾Ð¿Ð»Ð°Ñ‚Ðµ" Width="170" MinWidth="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Padding="8,4"
                                                   VerticalAlignment="Center"
                                                   Foreground="{StaticResource PrimaryColor}" FontWeight="Bold"
                                                   Text="{Binding Path=., Converter={StaticResource TotalPaymentConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    
                    <Border Grid.Row="2" Background="{StaticResource AccentLightColor}" 
                            BorderBrush="{StaticResource PrimaryColor}" BorderThickness="0,2,0,0" 
                            Padding="12,10" Margin="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="130"/>
                                <ColumnDefinition Width="180"/>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="170"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Ð˜Ð¢ÐžÐ“Ðž:" FontWeight="Bold" FontSize="14" 
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="3" x:Name="TotalNetTextBlock" Text="0.00" 
                                       FontWeight="Bold" FontSize="14" HorizontalAlignment="Right" 
                                       VerticalAlignment="Center" Padding="8,4"/>
                            <TextBlock Grid.Column="4" x:Name="TotalNdflTextBlock" Text="0.00" 
                                       FontWeight="Bold" FontSize="14" HorizontalAlignment="Right" 
                                       VerticalAlignment="Center" Padding="8,4"/>
                            <TextBlock Grid.Column="5" x:Name="TotalIndexedNetTextBlock" Text="0.00" 
                                       FontWeight="Bold" FontSize="14" HorizontalAlignment="Right" 
                                       VerticalAlignment="Center" Padding="8,4"
                                       Foreground="{StaticResource PrimaryColor}"/>
                            <TextBlock Grid.Column="6" x:Name="PaymentsTotalUnderpaymentTextBlock" Text="0.00" 
                                       FontWeight="Bold" FontSize="14" HorizontalAlignment="Right" 
                                       VerticalAlignment="Center" Padding="8,4"
                                       Foreground="{StaticResource WarningColor}"/>
                            <TextBlock Grid.Column="7" x:Name="PaymentsTotalCompensationTextBlock" Text="0.00" 
                                       FontWeight="Bold" FontSize="14" HorizontalAlignment="Right" 
                                       VerticalAlignment="Center" Padding="8,4"
                                       Foreground="{StaticResource WarningColor}"/>
                            <TextBlock Grid.Column="8" x:Name="PaymentsTotalToPayTextBlock" Text="0.00" 
                                       FontWeight="Bold" FontSize="15" HorizontalAlignment="Right" 
                                       VerticalAlignment="Center" Padding="8,4"
                                       Foreground="{StaticResource PrimaryColor}"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>
        
        <Border Grid.Row="1" Background="White" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,1,0,0" Padding="15">
            <Grid>
                <Label x:Name="StatusLabel" Content="Ð“Ð¾Ñ‚Ð¾Ð²Ð¾" HorizontalAlignment="Left" VerticalAlignment="Center" 
                       Foreground="{StaticResource TextSecondaryColor}" FontSize="13"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="ðŸ“Š Excel" Style="{StaticResource SecondaryButtonStyle}" 
                            Margin="0,0,10,0" Padding="16,10" Click="ExportExcel_Click"
                            ToolTip="Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð² Excel Ñ„Ð°Ð¹Ð»"/>
                    <Button Content="ðŸ“„ CSV" Style="{StaticResource SecondaryButtonStyle}" 
                            Padding="16,10" Click="ExportCsv_Click"
                            ToolTip="Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð² CSV Ñ„Ð°Ð¹Ð»"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
